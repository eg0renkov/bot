# üîó –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –Ø–Ω–¥–µ–∫—Å —Å–µ—Ä–≤–∏—Å–∞–º–∏

## üìã –û–±–∑–æ—Ä –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

–í–∞—à –±–æ—Ç —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å:
- üìß **–Ø–Ω–¥–µ–∫—Å.–ü–æ—á—Ç–∞** - —á—Ç–µ–Ω–∏–µ, –æ—Ç–ø—Ä–∞–≤–∫–∞, –∞–Ω–∞–ª–∏–∑ –ø–∏—Å–µ–º
- üìÖ **–Ø–Ω–¥–µ–∫—Å.–ö–∞–ª–µ–Ω–¥–∞—Ä—å** - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π, –ø—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è

## üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ OAuth –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ –Ø–Ω–¥–µ–∫—Å–µ

1. –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ [oauth.yandex.ru](https://oauth.yandex.ru)
2. –í–æ–π—Ç–∏ –≤ –Ø–Ω–¥–µ–∫—Å –∞–∫–∫–∞—É–Ω—Ç
3. –ù–∞–∂–∞—Ç—å "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
4. –ó–∞–ø–æ–ª–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ:
   - **–ù–∞–∑–≤–∞–Ω–∏–µ**: AI Telegram Bot
   - **–û–ø–∏—Å–∞–Ω–∏–µ**: –£–º–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–æ—á—Ç–æ–π –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º
   - **–ü–ª–∞—Ç—Ñ–æ—Ä–º—ã**: –í–µ–±-—Å–µ—Ä–≤–∏—Å—ã
   - **Callback URL**: `https://–≤–∞—à-–¥–æ–º–µ–Ω.com/yandex/callback`

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π

–í—ã–±—Ä–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:

**–î–ª—è –ø–æ—á—Ç—ã:**
- `mail:read` - —á—Ç–µ–Ω–∏–µ –ø–∏—Å–µ–º
- `mail:write` - –æ—Ç–ø—Ä–∞–≤–∫–∞ –ø–∏—Å–µ–º

**–î–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è:**
- `calendar:read` - —á—Ç–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π
- `calendar:write` - —Å–æ–∑–¥–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π

### –®–∞–≥ 3: –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–ª—É—á–∏—Ç–µ:
- **Client ID** (–∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- **Client Secret** (—Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á)

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞

### –î–æ–±–∞–≤–∏—Ç—å –≤ .env —Ñ–∞–π–ª:

```env
# –Ø–Ω–¥–µ–∫—Å OAuth (–ø–æ–ª—É—á–∏—Ç—å –Ω–∞ oauth.yandex.ru)
YANDEX_CLIENT_ID=–≤–∞—à_client_id
YANDEX_CLIENT_SECRET=–≤–∞—à_client_secret

# URL –¥–ª—è OAuth callback (–Ω–∞—Å—Ç—Ä–æ–∏—Ç—å webhook)
YANDEX_REDIRECT_URI=https://–≤–∞—à-–¥–æ–º–µ–Ω.com/yandex/callback
```

## üåê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Webhook —Å–µ—Ä–≤–µ—Ä–∞

–î–ª—è –ø–æ–ª–Ω–æ–π —Ä–∞–±–æ—Ç—ã OAuth –Ω—É–∂–µ–Ω –≤–µ–±-—Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ callback'–æ–≤:

### –ü—Ä–æ—Å—Ç–æ–π Flask —Å–µ—Ä–≤–µ—Ä:

```python
from flask import Flask, request, redirect
import requests

app = Flask(__name__)

@app.route('/yandex/callback')
def yandex_callback():
    code = request.args.get('code')
    state = request.args.get('state')
    
    # –û–±–º–µ–Ω—è—Ç—å –∫–æ–¥ –Ω–∞ —Ç–æ–∫–µ–Ω
    token_data = exchange_code_for_token(code)
    
    # –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–∫–µ–Ω –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
    # save_user_token(user_id, service, token_data)
    
    return "‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞! –í–µ—Ä–Ω–∏—Ç–µ—Å—å –≤ Telegram –±–æ—Ç–∞."

def exchange_code_for_token(code):
    url = "https://oauth.yandex.ru/token"
    data = {
        "grant_type": "authorization_code",
        "code": code,
        "client_id": "–≤–∞—à_client_id",
        "client_secret": "–≤–∞—à_client_secret",
        "redirect_uri": "https://–≤–∞—à-–¥–æ–º–µ–Ω.com/yandex/callback"
    }
    response = requests.post(url, data=data)
    return response.json()

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=80)
```

## üöÄ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–µ —Å–ø–æ—Å–æ–±—ã

### 1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ngrok (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ngrok
pip install pyngrok

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç—É–Ω–Ω–µ–ª—å
ngrok http 5000

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–ª—É—á–µ–Ω–Ω—ã–π URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö OAuth
```

### 2. –î–µ–ø–ª–æ–π –Ω–∞ –æ–±–ª–∞—á–Ω—ã–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã

- **Heroku**: –ø—Ä–æ—Å—Ç–æ–π –¥–µ–ø–ª–æ–π Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- **Vercel**: serverless —Ñ—É–Ω–∫—Ü–∏–∏
- **Railway**: –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–Ω—ã–π –¥–µ–ø–ª–æ–π
- **VPS**: —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Å–µ—Ä–≤–µ—Ä

## üì± –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π

### –ü–æ—Å–ª–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ OAuth:

1. **–í –±–æ—Ç–µ –Ω–∞–∂–∞—Ç—å "üìß –ü–æ—á—Ç–∞"**
2. **–í—ã–±—Ä–∞—Ç—å "üîó –ü–æ–¥–∫–ª—é—á–∏—Ç—å –ø–æ—á—Ç—É"**
3. **–ü—Ä–æ–π—Ç–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –≤ –±—Ä–∞—É–∑–µ—Ä–µ**
4. **–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –±–æ—Ç–∞**

### –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:

**–ü–æ—á—Ç–∞:**
- üì® "–ü–æ–∫–∞–∂–∏ –≤—Ö–æ–¥—è—â–∏–µ –ø–∏—Å—å–º–∞"
- ‚úçÔ∏è "–ù–∞–ø–∏—à–∏ –ø–∏—Å—å–º–æ –ò–≤–∞–Ω—É –ø—Ä–æ –≤—Å—Ç—Ä–µ—á—É"
- üîç "–ù–∞–π–¥–∏ –ø–∏—Å—å–º–∞ –æ—Ç –±–∞–Ω–∫–∞"
- üìã "–°–æ—Ö—Ä–∞–Ω–∏ –ø–∏—Å—å–º–æ –≤ —á–µ—Ä–Ω–æ–≤–∏–∫–∏"

**–ö–∞–ª–µ–Ω–¥–∞—Ä—å:**
- üìÖ "–ß—Ç–æ —É –º–µ–Ω—è —Å–µ–≥–æ–¥–Ω—è?"
- ‚ûï "–°–æ–∑–¥–∞–π –≤—Å—Ç—Ä–µ—á—É –∑–∞–≤—Ç—Ä–∞ –≤ 15:00"
- üîî "–ù–∞–ø–æ–º–Ω–∏ –∑–∞ —á–∞—Å –¥–æ –≤—Å—Ç—Ä–µ—á–∏"
- üë• "–ü—Ä–∏–≥–ª–∞—Å–∏ –∫–æ–º–∞–Ω–¥—É –Ω–∞ —Å–æ–∑–≤–æ–Ω"

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π Yandex OAuth 2.0
- ‚úÖ –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω–æ
- ‚úÖ –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–º —Ñ—É–Ω–∫—Ü–∏—è–º
- ‚úÖ –¢–æ–∫–µ–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–æ–∑–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∂–∏–º —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (–±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ OAuth):

–í `.env` —Ñ–∞–π–ª–µ:
```env
# –û—Ç–∫–ª—é—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
YANDEX_CLIENT_ID=
YANDEX_CLIENT_SECRET=
```

–í —ç—Ç–æ–º —Å–ª—É—á–∞–µ –±–æ—Ç –ø–æ–∫–∞–∂–µ—Ç –∑–∞–≥–ª—É—à–∫–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π.

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –º–æ–∫–∞–º–∏:

```python
# –î–æ–±–∞–≤–∏—Ç—å –≤ settings.py
DEVELOPMENT_MODE = True

# –í –∫–æ–¥–µ –ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–µ–∂–∏–º:
if settings.DEVELOPMENT_MODE:
    return mock_yandex_data()
else:
    return real_yandex_api_call()
```

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

### –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:

**"Redirect URI mismatch"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö OAuth —Ç–æ—á–Ω–æ —Å–æ–≤–ø–∞–¥–∞–µ—Ç

**"Invalid client"**
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Client ID –∏ Secret –≤ .env —Ñ–∞–π–ª–µ

**"Access denied"**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫–ª–æ–Ω–∏–ª –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–Ω–æ–≤–æ

**"Token expired"**
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

### –õ–æ–≥–∏ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏ API –∑–∞–ø—Ä–æ—Å–æ–≤.

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å OAuth –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. ‚úÖ –†–∞–∑–≤–µ—Ä–Ω—É—Ç—å webhook —Å–µ—Ä–≤–µ—Ä  
3. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫
5. ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å refresh —Ç–æ–∫–µ–Ω–æ–≤
6. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ —Ñ—É–Ω–∫—Ü–∏–π API

–ì–æ—Ç–æ–≤—ã –∫ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–º—É AI-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç—É! üöÄ